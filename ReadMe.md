**Курс 'Инженер данных'. Итоговая аттестация**

Схема таблицы-результата:

| Имя поля  | Тип поля |
|:---------:|:--------:|
|  date   |   Date   |
| percentage_zero |  Double  |
| cheapest_zero |   Double   |
| dearest_zero |   Double   |
| percentage_1p |   Double   |
| cheapest_1p |   Double   |
| dearest_1p |   Double   |
| percentage_2p |   Double   |
| dearest_2p |   Double   |
| percentage_3p |   Double   |
| percentage_3p |   Double   |
| cheapest_3p |   Double   |
| dearest_3p |   Double   |
| percentage_4plus |Double   |
| cheapest_4plus |   Double   |
| dearest_4plus |   Double   |

Для ускорения обработки данных на локальной машине была написана функиця конвертации исходной таблицы в формат parquet.


Так же к исходным данным была добвалена колонка, содержащая даты поездок без времени, что бы можно было по ним 
сгруппировать исходные данные и получить нужные нам значения для всех пяти групп


Далее всё тривиально: пробегаемся по всем датам и арргегируем полученные значения в результатирующей таблице, после чего сохраняем ее на диск


**Дополнительное задание**

Так же все просто - добавляем в датасет дополнительное поле, содержащее округлённое до следующего целого значение пройденного
растояния, затем группируем по этому полю и отфильтовываем то пройденное растояние, где чаевые отсутствовали или количество 
поездок было меньше 20. Сохраняем полученный результат для поледующей визуализации в python'е.
Картинка ниже отображает соотношение пройденой дистанции и количества чаевых, где синий график - выгрузка из нашего 
датасета, а оранжевый - линейный график  **_y = 0.3781906012902321x + 0.3031735051330209_**, приблизительно
описывающий зависимость количества чаевых от пройденного расстояния. Jupyter notebook, рисующий график и вычисляющий
коофициэнты линейной функции можно найти в папке ./python

![](https://github.com/KurlesHS/de-attestation/blob/master/images/dist_and_tip.png?raw=true)



